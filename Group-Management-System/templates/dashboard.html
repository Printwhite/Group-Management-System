<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»ªè¡¨æ¿ - é¢†å¯¼å·¥ä½œæµç¨‹ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="dashboard-page">
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h2>å·¥ä½œæµç¨‹ç®¡ç†</h2>
            </div>
            <div class="nav-user">
                <span>æ¬¢è¿ï¼Œ{{ current_user.name }}</span>
                <a href="{{ url_for('logout') }}" class="btn btn-outline">é€€å‡º</a>
            </div>
        </div>
    </nav>
    
    <div class="dashboard-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3>åŠŸèƒ½èœå•</h3>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="calendar">
                    <span class="nav-icon">ğŸ“…</span>
                    æ—¥å†è§†å›¾
                </a>
                <a href="#" class="nav-item" data-view="tasks">
                    <span class="nav-icon">ğŸ“‹</span>
                    ä»»åŠ¡åˆ—è¡¨
                </a>
                {% if current_user.role == 'manager' %}
                <a href="#" class="nav-item" data-view="users">
                    <span class="nav-icon">ğŸ‘¥</span>
                    ç”¨æˆ·ç®¡ç†
                </a>

                {% endif %}
            </nav>
        </div>
        
        <main class="main-content">
            <!-- æ—¥å†è§†å›¾ -->
            <div id="calendar-view" class="view active">
                <div class="view-header">
                    <h2>æ—¥å†è§†å›¾</h2>
                    {% if current_user.role == 'employee' %}
                    <button class="btn btn-primary" onclick="openTaskModal()">æ·»åŠ ä»»åŠ¡</button>
                    {% endif %}
                </div>
                
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="btn btn-outline" onclick="previousMonth()">â€¹</button>
                        <h3 id="current-month">2024å¹´1æœˆ</h3>
                        <button class="btn btn-outline" onclick="nextMonth()">â€º</button>
                    </div>
                    
                    <div class="calendar-grid">
                        <div class="calendar-weekdays">
                            <div>æ—¥</div>
                            <div>ä¸€</div>
                            <div>äºŒ</div>
                            <div>ä¸‰</div>
                            <div>å››</div>
                            <div>äº”</div>
                            <div>å…­</div>
                        </div>
                        <div id="calendar-days" class="calendar-days"></div>
                    </div>
                </div>
            </div>
            
                         <!-- ä»»åŠ¡åˆ—è¡¨è§†å›¾ -->
             <div id="tasks-view" class="view">
                 <div class="view-header">
                     <h2>ä»»åŠ¡åˆ—è¡¨</h2>
                     <div class="view-actions">
                         <div class="filter-group">
                             <input type="date" id="start-date-filter" class="form-input" placeholder="å¼€å§‹æ—¥æœŸ">
                             <input type="date" id="end-date-filter" class="form-input" placeholder="ç»“æŸæ—¥æœŸ">
                             <button class="btn btn-outline" onclick="filterTasks()">ç­›é€‰</button>
                             {% if current_user.role == 'manager' %}
                             <button class="btn btn-primary" onclick="exportCSV()">å¯¼å‡ºCSV</button>
                             {% endif %}
                         </div>
                         {% if current_user.role == 'employee' %}
                         <button class="btn btn-primary" onclick="openTaskModal()">æ·»åŠ ä»»åŠ¡</button>
                         {% endif %}
                     </div>
                 </div>
                 
                 <div id="tasks-list" class="tasks-list"></div>
             </div>
            
            <!-- ç”¨æˆ·ç®¡ç†è§†å›¾ï¼ˆä»…é¢†å¯¼å¯è§ï¼‰ -->
            {% if current_user.role == 'manager' %}
            <div id="users-view" class="view">
                <div class="view-header">
                    <h2>ç”¨æˆ·ç®¡ç†</h2>
                </div>
                
                <div id="users-list" class="users-list"></div>
            </div>
            

            {% endif %}
        </main>
    </div>
    
    <!-- ä»»åŠ¡æ¨¡æ€æ¡† -->
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">æ·»åŠ ä»»åŠ¡</h3>
                <button class="modal-close" onclick="closeTaskModal()">&times;</button>
            </div>
            <form id="task-form" class="modal-body">
                <input type="hidden" id="task-id">
                <div class="form-group">
                    <label for="task-title">ä»»åŠ¡æ ‡é¢˜</label>
                    <input type="text" id="task-title" required>
                </div>
                <div class="form-group">
                    <label for="task-description">ä»»åŠ¡æè¿°</label>
                    <textarea id="task-description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="task-date">æ—¥æœŸ</label>
                    <input type="date" id="task-date" required>
                </div>
                <div class="form-group">
                    <label for="task-priority">ä¼˜å…ˆçº§</label>
                    <select id="task-priority">
                        <option value="low">ä½</option>
                        <option value="medium" selected>ä¸­</option>
                        <option value="high">é«˜</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="task-status">çŠ¶æ€</label>
                    <select id="task-status">
                        <option value="in_progress" selected>è¿›è¡Œä¸­</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-outline" onclick="closeTaskModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>

    <!-- æ—¥ç¨‹è¡¨æ¨¡æ€æ¡†ï¼ˆç®¡ç†å‘˜ä¸“ç”¨ï¼‰ -->
    <div id="schedule-modal" class="modal">
        <div class="modal-content schedule-modal-content">
            <div id="schedule-modal-content">
                <!-- æ—¥ç¨‹è¡¨å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html> 